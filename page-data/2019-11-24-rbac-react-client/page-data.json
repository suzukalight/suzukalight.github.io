{"componentChunkName":"component---src-components-templates-blog-post-source-github-js","path":"/2019-11-24-rbac-react-client/","webpackCompilationHash":"9d92a21a48f2254cf2ed","result":{"data":{"site":{"siteMetadata":{"title":"suzukalight.com","author":"suzukalight"}},"markdownRemark":{"id":"0c5d29fc-1aac-5792-bb71-6926893d4e65","excerpt":"アクセス制御の手法のひとつである Role-based Access Control (RBAC) は、ユーザと権限とを直接紐付けるのではなく、間にロールを挟みこむことで権限管理をシンプルにする手法です。これを React…","html":"<p>アクセス制御の手法のひとつである <strong>Role-based Access Control (RBAC)</strong> は、ユーザと権限とを直接紐付けるのではなく、間にロールを挟みこむことで権限管理をシンプルにする手法です。これを React ベースのアプリに組み込むための、簡単な実装例を作成しました。</p>\n<p>実装したリポジトリはこちらです；<br>\n<a href=\"https://github.com/suzukalight/study-rbac-client\" target=\"_blank\" rel=\"noopener\">https://github.com/suzukalight/study-rbac-client</a></p>\n<h1 id=\"role-based-access-control\"><a href=\"#role-based-access-control\" aria-label=\"role based access control permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Role-based Access Control</h1>\n<p>通常、ユーザに認可を割り付ける場合、直接的に紐付けることが多いかと思います。「〇〇さんは ×× ができる」という関係性です；</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">User - Permission</code></pre></div>\n<p>Role-based Access Control は、ユーザと許可とを直接紐付けるのではなく、<strong>間に役割(Role)を挟みこんだ 3 段階の権限管理を行っています</strong>；</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">User - Role - Permission</code></pre></div>\n<p>誰が何をできるか？という設定は緻密で具体的ではありますが、その繊細さゆえに設定ミスを誘発しがちになります。Role を挟むことにより、「<strong>その役割の人なら、これらの振る舞いが認可される</strong>」という関係性を定義することができるようになります。</p>\n<p>たとえば異動したユーザに対して、許可をひとつひとつ剥がしてひとつひとつ付け直すよりも、役割を 1 つだけ付け直すほうが、明らかにミスが減りますよね。</p>\n<h1 id=\"セットアップ\"><a href=\"#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\" aria-label=\"セットアップ permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>セットアップ</h1>\n<h2 id=\"何を作るか？\"><a href=\"#%E4%BD%95%E3%82%92%E4%BD%9C%E3%82%8B%E3%81%8B%EF%BC%9F\" aria-label=\"何を作るか？ permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>何を作るか？</h2>\n<p>投稿管理システムを素振りしてみます。役割として「ビジター」「執筆者」「管理者」の 3 種類を想定し、それぞれの役割に応じて閲覧や操作の許可をコントロールできる機能を実装していきます；</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/28fa002a0fd1bbe5c3a826799d694538/c7805/post-list.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 97.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABvklEQVQ4y61U14oCQRDc/3/zM0RQxPCggihmMAfMOeectY5q2OPO2zvc5QZ6Z7Z3pna6q7qVRCKBdDqNarWKVqslc7vdRqfTQSaTQaVSEX+tVkMwGEQymUQul0O9Xkc+n0e5XJY1fbfbDYrH44Hb7YbX64Xf74fT6UQsFkMkEhEAfnO5XALkcDhkTX+v15Mz3M93u92O4/EIBf88lMlkglKphM1mI477/Y7n84nH4/HNXn2/7VH4UAedHF99XOsxxWw2w2KxwOfzwWq1Sl5MJpPk7ivg2yGvVivMZjMcDgcxhr5cLrFYLH78/fX2moB8nM9njMdjnE6nPze/c1OF2pnP5ygUCqKp4XCIRqOBYrGIZrOJbrcrppVfTcDr9SrhpVIpZLNZAaUG+/0+9vu9pICzrpC1QtI6+FbINpsN8XgcoVBIyiwQCEgZqTLSTQprlwAMl7ljXTN3RiTzSQrZZa5YJZzX6zW2260xHbJTkOFwOCxEcI5Go9JhDAFSMszdYDAQtqfTqazJrOEbqr1QbRCvQLoA2TipPfY3luFoNJLQd7ud8Ruy85Jh1jCbJAlhORoCZN5Uu1wuuoX8Oj4ACa/+ITe5u2IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"post list\"\n        title=\"\"\n        src=\"/static/28fa002a0fd1bbe5c3a826799d694538/c7805/post-list.png\"\n        srcset=\"/static/28fa002a0fd1bbe5c3a826799d694538/01387/post-list.png 320w,\n/static/28fa002a0fd1bbe5c3a826799d694538/c7805/post-list.png 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n      />\n  </span>\n  </a></p>\n<p>このスクリーンショットの場合は、執筆者 1 でログインしており、執筆者 1 が書いた記事 2 件について、編集が許可されている感じです。他の記事への編集許可や、自身の記事も含めた削除許可は得ていません。</p>\n<h2 id=\"参考にした実装\"><a href=\"#%E5%8F%82%E8%80%83%E3%81%AB%E3%81%97%E3%81%9F%E5%AE%9F%E8%A3%85\" aria-label=\"参考にした実装 permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考にした実装</h2>\n<p>実装する側としては、段階が 1 つ増えるため実装コストが上がってしまうのではないか、という懸念が発生しますが…、実際に作成してみると、それほどでもありませんでした。</p>\n<p><a href=\"https://auth0.com/blog/role-based-access-control-rbac-and-react-apps/\" target=\"_blank\" rel=\"noopener\">https://auth0.com/blog/role-based-access-control-rbac-and-react-apps/</a></p>\n<p>こちらの実装を基本としつつ、Consumer を useContext に置き換えたり、typescript で書き換えたりなど、より現代的な実装に移したものが、今回の実装になります。</p>\n<h2 id=\"環境構築\"><a href=\"#%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\" aria-label=\"環境構築 permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>環境構築</h2>\n<p>素振り用に create-react-app —typescript します；</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ npx create-react-app study-rbac-client --typescript\n$ <span class=\"token function\">cd</span> study-rbac-client\n$ <span class=\"token function\">yarn</span></code></pre></div>\n<p>react-router-dom をインストールします；</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">yarn</span> <span class=\"token function\">add</span> react-router-dom @types/react-router-dom</code></pre></div>\n<h1 id=\"権限\"><a href=\"#%E6%A8%A9%E9%99%90\" aria-label=\"権限 permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>権限</h1>\n<h2 id=\"permission\"><a href=\"#permission\" aria-label=\"permission permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Permission</h2>\n<p>「<strong>何に対して</strong>」と「<strong>どういう振る舞い(perform/action)か</strong>」という 2 つの述語を用いて記述します。文字列定数として表現します；</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token punctuation\">[</span>\n  <span class=\"token string\">'posts:list'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'posts:create'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'posts:edit'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'posts:delete'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'users:get'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'users:getSelf'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'home-page:visit'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"ルールテーブルの作成\"><a href=\"#%E3%83%AB%E3%83%BC%E3%83%AB%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90\" aria-label=\"ルールテーブルの作成 permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ルールテーブルの作成</h2>\n<p>Role と Permission の関係を記述するテーブルを用意します。関係性は大きく <strong>static</strong> と <strong>dynamic</strong> に分けています。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> rules<span class=\"token punctuation\">:</span> Rule <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  visitor<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'posts:list'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'home-page:visit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  writer<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'posts:list'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'posts:create'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'users:getSelf'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'home-page:visit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    dynamic<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">'posts:edit'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> userId<span class=\"token punctuation\">,</span> postOwnerId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> PostsEditParams</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>userId <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>postOwnerId<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> userId <span class=\"token operator\">===</span> postOwnerId<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  admin<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">'posts:list'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'posts:create'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'posts:edit'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'posts:delete'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'users:get'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'users:getSelf'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'home-page:visit'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>static: string[]</strong><br>\n「その Role を持っている場合、<strong>無条件で Permission を得られる</strong>」という関係性です。たとえば「Admin であれば、すべての記事の削除権限を得る」などです。</p>\n<p><strong>dynamic: { [key: string]: Function }</strong><br>\n「その Role を持っている場合、<strong>指定した関数を実行し、結果が true であれば Permission を得られる</strong>」という関係性です。たとえば「その記事のオーナーであれば、編集権限を得る」などです。この場合、記事の OwnerId と、actor の userId とが検査対象となり、それらを dynamic 関数に引き渡してチェックします。</p>\n<h2 id=\"権限チェック関数\"><a href=\"#%E6%A8%A9%E9%99%90%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E9%96%A2%E6%95%B0\" aria-label=\"権限チェック関数 permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>権限チェック関数</h2>\n<p>ルールテーブルを用いて、当該 actor が対象への Permission を持つかをチェックする関数を用意します；</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Rule <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./rbac-rules'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">check</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">rules<span class=\"token punctuation\">:</span> Rule<span class=\"token punctuation\">,</span> role<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> Object</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> permissions <span class=\"token operator\">=</span> rules<span class=\"token punctuation\">[</span>role<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>permissions<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> staticPermissions <span class=\"token operator\">=</span> permissions<span class=\"token punctuation\">.</span><span class=\"token keyword\">static</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>staticPermissions <span class=\"token operator\">&amp;&amp;</span> staticPermissions<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> dynamicPermissions <span class=\"token operator\">=</span> permissions<span class=\"token punctuation\">.</span>dynamic<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dynamicPermissions<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> permissionCondition <span class=\"token operator\">=</span> dynamicPermissions<span class=\"token punctuation\">[</span>action<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>permissionCondition<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">permissionCondition</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>check: (rules: Rule, role: string, action: string, data?: Object) => boolean</strong></p>\n<ul>\n<li>rules: ルールテーブル情報</li>\n<li>role: 当該 actor の持つ権限</li>\n<li>action: どの振る舞いに対する Permission をチェックするか</li>\n<li>data?: dynamic permission に渡すデータ</li>\n</ul>\n<p>static ルールであれば配列内検索の結果を、dynamic ルールであれば関数の実行結果を、それぞれ評価して戻り値にしている、というシンプルな実装です。</p>\n<h1 id=\"権限の利用\"><a href=\"#%E6%A8%A9%E9%99%90%E3%81%AE%E5%88%A9%E7%94%A8\" aria-label=\"権限の利用 permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>権限の利用</h1>\n<h2 id=\"ヘルパコンポーネント：権限があれば子ノードを表示する\"><a href=\"#%E3%83%98%E3%83%AB%E3%83%91%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%EF%BC%9A%E6%A8%A9%E9%99%90%E3%81%8C%E3%81%82%E3%82%8C%E3%81%B0%E5%AD%90%E3%83%8E%E3%83%BC%E3%83%89%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\" aria-label=\"ヘルパコンポーネント：権限があれば子ノードを表示する permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ヘルパコンポーネント：権限があれば子ノードを表示する</h2>\n<p>「Permission を持っている actor の場合にのみ、子ノードを表示する」という機能を提供するコンポーネントを作ります；</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> check <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../../check'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> rules <span class=\"token keyword\">from</span> <span class=\"token string\">'../../../rbac-rules'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">CanParams</span> <span class=\"token punctuation\">{</span>\n  role<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  perform<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  data<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> Object<span class=\"token punctuation\">;</span>\n  yes<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Function</span><span class=\"token punctuation\">;</span>\n  no<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Function</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> Can<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token operator\">&lt;</span>CanParams<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children<span class=\"token punctuation\">,</span> role<span class=\"token punctuation\">,</span> perform<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> yes<span class=\"token punctuation\">,</span> <span class=\"token function-variable function\">no</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">check</span><span class=\"token punctuation\">(</span>rules<span class=\"token punctuation\">,</span> role<span class=\"token punctuation\">,</span> perform<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">no</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>yes<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">yes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> children<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Can<span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"自身の情報を取得できる場合にプロフィールを表示する\"><a href=\"#%E8%87%AA%E8%BA%AB%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AB%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\" aria-label=\"自身の情報を取得できる場合にプロフィールを表示する permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>自身の情報を取得できる場合にプロフィールを表示する</h2>\n<p>Can コンポーネントを利用して、プロフィール表示コンポーネントを作成してみます；</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> Can <span class=\"token keyword\">from</span> <span class=\"token string\">'../../atoms/Can'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useAuth <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../contexts/Auth'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> Profile<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">FC</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> user <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useAuth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Can role<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>role<span class=\"token punctuation\">}</span> perform<span class=\"token operator\">=</span><span class=\"token string\">\"users:getSelf\"</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>User Profile<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>ul<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span><span class=\"token constant\">ID</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>Email<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>Role<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>role<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ul<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Can<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Profile<span class=\"token punctuation\">;</span></code></pre></div>\n<p>処理としては最も単純で、role が perform を許可されているかを static にチェックするだけです。</p>\n<h2 id=\"自身の記事か、管理者の場合のみ、編集できる\"><a href=\"#%E8%87%AA%E8%BA%AB%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%8B%E3%80%81%E7%AE%A1%E7%90%86%E8%80%85%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AE%E3%81%BF%E3%80%81%E7%B7%A8%E9%9B%86%E3%81%A7%E3%81%8D%E3%82%8B\" aria-label=\"自身の記事か、管理者の場合のみ、編集できる permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>自身の記事か、管理者の場合のみ、編集できる</h2>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> Can <span class=\"token keyword\">from</span> <span class=\"token string\">'../../atoms/Can'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">PostParams</span> <span class=\"token punctuation\">{</span>\n  user<span class=\"token punctuation\">:</span> User<span class=\"token punctuation\">;</span>\n  post<span class=\"token punctuation\">:</span> Post<span class=\"token punctuation\">;</span>\n  index<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> Post<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token operator\">&lt;</span>PostParams<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> user<span class=\"token punctuation\">,</span> post<span class=\"token punctuation\">,</span> index <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>th scope<span class=\"token operator\">=</span><span class=\"token string\">\"row\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>th<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Can\n        role<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>role<span class=\"token punctuation\">}</span>\n        perform<span class=\"token operator\">=</span><span class=\"token string\">\"posts:edit\"</span>\n        data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          userId<span class=\"token punctuation\">:</span> user<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n          postOwnerId<span class=\"token punctuation\">:</span> post<span class=\"token punctuation\">.</span>ownerId<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button<span class=\"token operator\">></span>Edit Post<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Can<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Can role<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>role<span class=\"token punctuation\">}</span> perform<span class=\"token operator\">=</span><span class=\"token string\">\"posts:delete\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button<span class=\"token operator\">></span>Delete Post<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Can<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>編集処理（posts:edit）</strong><br>\nルールテーブルによると、writer の場合は dynamic、admin の場合は static に permission チェックが行われます。dynamic permission を使用するため、data オブジェクトも付与しています。</p>\n<p>この例では、writer ロールの場合、そのユーザの ID と、記事のオーナー ID とを比較し、合致している場合のみ、子ノードが表示されるという振る舞いを想定しています。</p>\n<p><strong>削除処理（posts:delete）</strong><br>\nadmin ロールを持つ場合にのみ、削除が許可されます。</p>\n<h1 id=\"認証認可-context\"><a href=\"#%E8%AA%8D%E8%A8%BC%E8%AA%8D%E5%8F%AF-context\" aria-label=\"認証認可 context permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>認証認可 Context</h1>\n<p>認証状態を管理できる、AuthContext と useAuth hook を作成しました；</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useContext<span class=\"token punctuation\">,</span> createContext<span class=\"token punctuation\">,</span> useCallback<span class=\"token punctuation\">,</span> useMemo <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> visitor<span class=\"token punctuation\">:</span> User <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  email<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  role<span class=\"token punctuation\">:</span> <span class=\"token string\">'visitor'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">AuthContextValues</span> <span class=\"token punctuation\">{</span>\n  authenticated<span class=\"token punctuation\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n  user<span class=\"token punctuation\">:</span> User<span class=\"token punctuation\">;</span>\n  accessToken<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function-variable function\">login</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">email<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">:</span> Object</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n  logout<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Function</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> AuthContext <span class=\"token operator\">=</span> createContext<span class=\"token operator\">&lt;</span>AuthContextValues<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  authenticated<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  user<span class=\"token punctuation\">:</span> visitor<span class=\"token punctuation\">,</span>\n  accessToken<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">login</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">logout</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> AuthProvider<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">FC</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>authenticated<span class=\"token punctuation\">,</span> setAuthenticated<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>user<span class=\"token punctuation\">,</span> setUser<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> useState<span class=\"token operator\">&lt;</span>User<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>accessToken<span class=\"token punctuation\">,</span> setAccessToken<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> login <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">email<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">,</span> role <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setAuthenticated</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">setUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">,</span> email<span class=\"token punctuation\">,</span> role <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">setAccessToken</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1234567890abcdef1234567890abcdef'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span>setAuthenticated<span class=\"token punctuation\">,</span> setUser<span class=\"token punctuation\">,</span> setAccessToken<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> logout <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setAuthenticated</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setUser</span><span class=\"token punctuation\">(</span>visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setAccessToken</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>setAuthenticated<span class=\"token punctuation\">,</span> setUser<span class=\"token punctuation\">,</span> setAccessToken<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> contextValue <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> authenticated<span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">,</span> accessToken<span class=\"token punctuation\">,</span> login<span class=\"token punctuation\">,</span> logout <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    authenticated<span class=\"token punctuation\">,</span>\n    user<span class=\"token punctuation\">,</span>\n    accessToken<span class=\"token punctuation\">,</span>\n    login<span class=\"token punctuation\">,</span>\n    logout<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>AuthContext<span class=\"token punctuation\">.</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>contextValue<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>AuthContext<span class=\"token punctuation\">.</span>Provider<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">useAuth</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> authenticated<span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">,</span> accessToken<span class=\"token punctuation\">,</span> login<span class=\"token punctuation\">,</span> logout <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>AuthContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    authenticated<span class=\"token punctuation\">,</span>\n    user<span class=\"token punctuation\">,</span>\n    accessToken<span class=\"token punctuation\">,</span>\n    login<span class=\"token punctuation\">,</span>\n    logout<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>サインイン・サインアウトの操作を行う場合は、この AuthContext から useAuth hook を経由して操作関数を受け取り、実行させることを想定しています；</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useAuth <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../contexts/Auth'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Login</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> authenticated<span class=\"token punctuation\">,</span> login<span class=\"token punctuation\">,</span> logout <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useAuth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>authenticated<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>button className<span class=\"token operator\">=</span><span class=\"token string\">\"btn btn-sm btn-primary\"</span> onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Logout\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button\n        className<span class=\"token operator\">=</span><span class=\"token string\">\"btn btn-sm btn-primary\"</span>\n        onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token string\">'one@test.com'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'password'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> role<span class=\"token punctuation\">:</span> <span class=\"token string\">'writer'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">></span>\n        Writer <span class=\"token number\">1</span> Login\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Login<span class=\"token punctuation\">;</span></code></pre></div>\n<p>ご覧の通り、サインイン処理はダミー実装ですので、実際に運用する場合は、間に API コールなどを挟む必要があります。Auth0 を利用しても良いと思いますし、passport などで自前実装しても良いと思います。</p>\n<h1 id=\"実行結果\"><a href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\" aria-label=\"実行結果 permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実行結果</h1>\n<p><strong>visitor</strong><br>\n記事の一覧が表示されるだけになっています；</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c9ef23fbd1978b91acfeab7e60545244/c7805/post-list-visitor.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABTElEQVQ4y6WTX4uCQBTF/f6fwpdeeutFEMGIsIyUokyiRK0Qy6CoHsr+eJZzodhdql1yYLjMOPc3x3vPKM1mE51OB57nYTAYYDQaYTweYzqdwrZt9Pt9Wfd6PRiGgVarheFwKOdd15XY7XYxm83AodTrdTQaDViWJWBeQAjh3CfEcRzZ0zQNuq7Lpb7vwzRNyWPkWoB4MoqiwCeDeUqWZVgsFmCk7P1+L3G5XCKKIqzXa6Rpivl8jjiOsVqtJPl2u+F6vf6IovBwOOByueB8PssNp9Pp8fGdkld/olQqFVSrVdRqNbTbbaiqKg24q2DS7/muLFJDquKBO+CZkv9CFdYmCALpKmtHW9AurN0nDRLgZDIR6G63w3a7xWazQZ7nnwGpih4Kw/ABKWMfheo4aZHvqv4q/ksgnxWdT6VsThljCzBJEoExHo/H0sAvy2vg/iMvDU0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"post list visitor\"\n        title=\"\"\n        src=\"/static/c9ef23fbd1978b91acfeab7e60545244/c7805/post-list-visitor.png\"\n        srcset=\"/static/c9ef23fbd1978b91acfeab7e60545244/01387/post-list-visitor.png 320w,\n/static/c9ef23fbd1978b91acfeab7e60545244/c7805/post-list-visitor.png 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n      />\n  </span>\n  </a></p>\n<p><strong>writer</strong><br>\n自分が書いた記事に対して、編集操作が行えるようになります；</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/28fa002a0fd1bbe5c3a826799d694538/c7805/post-list.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 97.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABvklEQVQ4y61U14oCQRDc/3/zM0RQxPCggihmMAfMOeectY5q2OPO2zvc5QZ6Z7Z3pna6q7qVRCKBdDqNarWKVqslc7vdRqfTQSaTQaVSEX+tVkMwGEQymUQul0O9Xkc+n0e5XJY1fbfbDYrH44Hb7YbX64Xf74fT6UQsFkMkEhEAfnO5XALkcDhkTX+v15Mz3M93u92O4/EIBf88lMlkglKphM1mI477/Y7n84nH4/HNXn2/7VH4UAedHF99XOsxxWw2w2KxwOfzwWq1Sl5MJpPk7ivg2yGvVivMZjMcDgcxhr5cLrFYLH78/fX2moB8nM9njMdjnE6nPze/c1OF2pnP5ygUCqKp4XCIRqOBYrGIZrOJbrcrppVfTcDr9SrhpVIpZLNZAaUG+/0+9vu9pICzrpC1QtI6+FbINpsN8XgcoVBIyiwQCEgZqTLSTQprlwAMl7ljXTN3RiTzSQrZZa5YJZzX6zW2260xHbJTkOFwOCxEcI5Go9JhDAFSMszdYDAQtqfTqazJrOEbqr1QbRCvQLoA2TipPfY3luFoNJLQd7ud8Ruy85Jh1jCbJAlhORoCZN5Uu1wuuoX8Oj4ACa/+ITe5u2IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"post list\"\n        title=\"\"\n        src=\"/static/28fa002a0fd1bbe5c3a826799d694538/c7805/post-list.png\"\n        srcset=\"/static/28fa002a0fd1bbe5c3a826799d694538/01387/post-list.png 320w,\n/static/28fa002a0fd1bbe5c3a826799d694538/c7805/post-list.png 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n      />\n  </span>\n  </a></p>\n<p><strong>admin</strong><br>\nすべての記事に対して、編集と削除操作が行えるようになります；</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6823bdfcda06b5c743e5d7bc5f5d6f41/c7805/post-list-admin.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 97.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB7ElEQVQ4y61U14pCMRC9//8DfoH44IuCglhA7AW7Yu/YsPfuWc5ARHbZNcIGwuRmMidn5kyu4fF44PP5EIlEkEqlxBYKBeRyOQQCAUSjUSSTSfHZbDa43W45Uy6XEQwGEQ6Hxe/3+3E+n2HEYjEJSiQSSKfTcjifz8skSCgUkkkAXkAQnh0Oh2AsfZlMRgCPxyMM/PMwZrMZGo0GttutbNzvd7GPx0PWt9tN5vf1q19Z7hmkyXG9XrFcLsWxWCykHgqYU5uh1WqFxWIBxbHb7XC5XDCZTHA6nc9DClAHWBgeDgdcLhfZoOXe6XR6sntl+Y6xQSfr1+/3UavVUK1Wfz2sxZC1ozClUknkZ3uwZWjZi7yAovFCHWBDicHgSqUiQPF4HJPJRIRi6pyqJG9T/iQ9rZTNZjO8Xi8cDgey2axYvhwO1VsficLUWB8+pdFohHq9jul0+oOZbusYVJiidLvd5+Z+vxch2u02VqvVZykziGJQCIJTgF6vJ4rz8ZMx+5QCaTFkygyiZapMfzAYCAi/ueYFu91OD7DVaklDN5tNAWUdCcr3TEswgrIMWoBMmQwpCus1Ho8FVK2VWGSsBcjiF4tFdDodAaA4ZDufz2WPfmahfm9vARmoJoM2mw3W67UwoiVT2tff2V/jCxjT9HNN4zZ6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"post list admin\"\n        title=\"\"\n        src=\"/static/6823bdfcda06b5c743e5d7bc5f5d6f41/c7805/post-list-admin.png\"\n        srcset=\"/static/6823bdfcda06b5c743e5d7bc5f5d6f41/01387/post-list-admin.png 320w,\n/static/6823bdfcda06b5c743e5d7bc5f5d6f41/c7805/post-list-admin.png 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n      />\n  </span>\n  </a></p>\n<h1 id=\"完成品\"><a href=\"#%E5%AE%8C%E6%88%90%E5%93%81\" aria-label=\"完成品 permalink\" class=\"gatsby-autolink-headers\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>完成品</h1>\n<p>実装したリポジトリはこちらです；<br>\n<a href=\"https://github.com/suzukalight/study-rbac-client\" target=\"_blank\" rel=\"noopener\">https://github.com/suzukalight/study-rbac-client</a></p>","tableOfContents":"<ul>\n<li><a href=\"/2019-11-24-rbac-react-client/#role-based-access-control\">Role-based Access Control</a></li>\n<li>\n<p><a href=\"/2019-11-24-rbac-react-client/#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\">セットアップ</a></p>\n<ul>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E4%BD%95%E3%82%92%E4%BD%9C%E3%82%8B%E3%81%8B%EF%BC%9F\">何を作るか？</a></li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E5%8F%82%E8%80%83%E3%81%AB%E3%81%97%E3%81%9F%E5%AE%9F%E8%A3%85\">参考にした実装</a></li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\">環境構築</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/2019-11-24-rbac-react-client/#%E6%A8%A9%E9%99%90\">権限</a></p>\n<ul>\n<li><a href=\"/2019-11-24-rbac-react-client/#permission\">Permission</a></li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E3%83%AB%E3%83%BC%E3%83%AB%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90\">ルールテーブルの作成</a></li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E6%A8%A9%E9%99%90%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E9%96%A2%E6%95%B0\">権限チェック関数</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/2019-11-24-rbac-react-client/#%E6%A8%A9%E9%99%90%E3%81%AE%E5%88%A9%E7%94%A8\">権限の利用</a></p>\n<ul>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E3%83%98%E3%83%AB%E3%83%91%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%EF%BC%9A%E6%A8%A9%E9%99%90%E3%81%8C%E3%81%82%E3%82%8C%E3%81%B0%E5%AD%90%E3%83%8E%E3%83%BC%E3%83%89%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\">ヘルパコンポーネント：権限があれば子ノードを表示する</a></li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E8%87%AA%E8%BA%AB%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AB%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\">自身の情報を取得できる場合にプロフィールを表示する</a></li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E8%87%AA%E8%BA%AB%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%8B%E3%80%81%E7%AE%A1%E7%90%86%E8%80%85%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AE%E3%81%BF%E3%80%81%E7%B7%A8%E9%9B%86%E3%81%A7%E3%81%8D%E3%82%8B\">自身の記事か、管理者の場合のみ、編集できる</a></li>\n</ul>\n</li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E8%AA%8D%E8%A8%BC%E8%AA%8D%E5%8F%AF-context\">認証認可 Context</a></li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\">実行結果</a></li>\n<li><a href=\"/2019-11-24-rbac-react-client/#%E5%AE%8C%E6%88%90%E5%93%81\">完成品</a></li>\n</ul>","frontmatter":{"title":"Role-Based Access Control (RBAC) を実践する","date":"2019-11-24T00:02:00","description":null,"category":"Technology","tags":["rbac","react","typescript"],"hero":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAAw0lEQVQoz5WS2wqDMBBE/f8f9MEoolHxrgj6ok6ZxZTQJq0OLEtuJ7PZBLh0nqcElec5oihClmWI4xhpmiIMQ8lJkkAphX3f3+dsBS5g3/foug7rumKaJhm3bYtxHDEMg6w9AjZNg7IsobUWqE+fMC+wrmspj0C6Oo5Dwuyx93od2ovMfEe6pNtlWbyAnw5NLopCmkGH9vw/mBNIVVUl3WSnt237uvAx0DSF2QbecekEsmSWy7fzfY9HwHmeJQi7W6rRCxN5D+uGw6DIAAAAAElFTkSuQmCC","aspectRatio":2,"src":"/static/f94891c5bfade290c46c4037acb5377c/f0df8/hero.png","srcSet":"/static/f94891c5bfade290c46c4037acb5377c/7b192/hero.png 320w,\n/static/f94891c5bfade290c46c4037acb5377c/abde0/hero.png 640w,\n/static/f94891c5bfade290c46c4037acb5377c/f0df8/hero.png 1280w,\n/static/f94891c5bfade290c46c4037acb5377c/e5c90/hero.png 1440w","sizes":"(max-width: 1280px) 100vw, 1280px"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"source":"github","slug":"/2019-11-24-rbac-react-client/","previous":{"head":{"title":"大分＋阿蘇旅行記（2019/11/16～4泊）","category":"Trip","tags":["大分","阿蘇","乗馬","twitter"],"date":"2019-11-16T00:08:00","slug":"/2019-11-16-trip-oita/","source":"github"},"siteMetadata":{"title":"suzukalight.com"}},"next":null}}}